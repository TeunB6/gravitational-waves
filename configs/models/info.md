The encoder and decoder configs are taken from Bacon et al. 